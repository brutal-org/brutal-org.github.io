---
title: Milestone 4
subtitle: The Year of the the Brutal Desktop
cover: /articles/milestone-4/cover.png
date: "2022-03-27"
authors: [ "Sleepy Monax"]
---

It's been a long time, 450 commits to be precise but we are back with a new milestone of the BRUTAL operating system! This one was focused on the desktop side of things, but also on improving our IPC framework.

## New Website

First, we rebuild the website from scratch with improved redabilty and layout. This website was built using the following tech stack:

- NextJS
- TailwindCSS
- MDX

You might think this is a bit overkill for a simple blog, but we have big plan for the future ;)

## Improved IPC and IDL

Next, our IPC framework got a big everhault with this release and add support for:

- Attributes
- Improved user defined types
- Modules
- Capabilities

Here is an exemple of an IPC module describing a simple event dispatcher, it will dispatch events to all the provided sinks.

```
module event;

import base, math;
include brutal/ui.h;

type Event = __ctype(UiEvent);

interface Sink
{
    method dispatch Event -> Bool;
};
```

When fed into our IDL compiler the interface can be easily used in C code like this:

```c
UiEvent event = ...;
bool captured = false;

EventError error = event_sink_dispatch_rpc(self, event_sink_port, &event, &captured);

if (error != EVENT_SUCCESS)
{
    // Handle error
}
```

Also our init system now supports manifest files instead of hard coded servers. For example, we can now have a manifest file for the `ps2` server:

```json
{
    "name": "ps2",
    "consume": ["system.Server", "event.Sink"],
    "rights": ["irq", "pio", "log"]
}
```

This manifest describe a server named `ps2` that consume the `system.Server` and the `event.Sink` interfaces. The `system.Server` interface is used to interact with the init system, and the `event.Sink` interface is used to dispatch events.

Servers can have different rights:

- `irq`: the server can bind to an IRQ
- `pio`: the server can interract with the CPU's IO ports
- `log`: the server can log messages to the kernel log

Theres is many more rights, but we will not go into them here.

## Graphic Library

After that, we built a full graphic library featuring vector graphics, bitmap graphics, and a lot of other cool stuff.

![Demonstration of SVG support](/articles/milestone-4/svg-path.png)

![Demonstration of Vector fonts support](/articles/milestone-4/vector-font.png)

## Widget Library

Based on the new IPC framework and the new graphic library, we built a new widget library.

![The BRUTAL Desktop](/articles/milestone-4/desktop.png)

NOTE: This is using our builtin fallback font since we don't have filesystem support yet

## General Improvements

On top of everythings stated above, fix countless bugs and improve the overall performance of the operating system. We continued working on our C compiler. Implemented basic support for ext2 filesystems.

## What's Next

Milestone 5 will focus on building the storage stack, and improve the stability of the system.

This roadmap is not set in stone, and is subject to changes. You might want to check out the <a href="https://github.com/brutal-org/brutal/blob/main/meta/roadmap.md">latest version of the roadmap</a>.

## Acknowledgements

![](/articles/milestone-3/thanks.png)

I (sleepy_monax) wanted to thank everyone who continue help Brutal to grow. Like every milestone before I'd like to thanks supercyp for all the work it did all around the system, Feliwir who just joined the projet and worked on Compression, Vector fonts, and the IO stack and <a href="https://github.com/brutal-org/brutal/graphs/contributors">everyone else</a> who contributed to this milestone!

## Contributing

We welcome all contribution even if they don't fit into our milestones :) The Git repository is available <a class="link" href="https://github.com/brutal-org/brutal">on GitHub</a> and you can chat with us on the <a class="link" href="http://discord.skiftos.org">Brutal discord server</a>, or if you speak french on the <a class="link" href="https://discord.com/invite/3XjkM6q">DEVSE discord server</a>.

Thanks for reading and happy hacking!
